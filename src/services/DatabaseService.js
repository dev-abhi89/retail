import firestore from '@react-native-firebase/firestore';
import auth from '@react-native-firebase/auth';
import data from '../Data';
const d = {
  t74P5HDedZbQwl0DoTOzoiNI2Yx2: {
    name: 'Ram',
    stores: [
      'ac533b7d-52fa-406f-9491-47c4502f67b9',
      'd596bacc-4c96-485f-a143-d1a493124c39',
      '4492786f-b73c-4a56-9955-8477b6d1f550',
      '7b732a57-3ea5-41ca-8354-301821dad093',
      '578fda8d-70d9-4c79-9514-3208b2bef883',
      'e0ff8552-e0b4-4630-8926-84513eeeae38',
      '50316c1d-c0fb-4257-ae2f-0bec31440eb0',
      '786912e4-9c02-46a8-84bb-74503caaaa5f',
      'fe766f3e-dac5-488c-b30f-909bbe459c04',
      '6f45944c-8f70-45fa-ab13-f471c50c5dcf',
      '581371a1-248c-4079-b734-ace6519b172b',
      '8171e277-241d-4e20-b0ee-e66f0a74191d',
      '6fa13a70-d034-4e45-ba9e-c57208e4e3a1',
      'dc9efefc-7712-44a2-a693-8bdc40808260',
      'd90272b8-da96-4177-8620-26befc7e96b8',
      '94295098-285a-4c2b-98f0-85164f0908d2',
      '4d472c2f-5ee9-4fa8-9d45-2fd8504c5caf',
      '9ebd2ef1-9de0-4de1-af93-11a1c122c256',
      '82e14632-3767-4d3d-a840-62fe67d06e4e',
      '0abf7f73-232e-43c3-a573-4762c83d910d',
      '4973dba9-ea97-49d7-834d-0c2705dd3c01',
      'd02565a6-8a98-4cb5-b95f-ae97e9abc800',
      'd2a654f6-9e13-402c-a4c7-0df3059ac8c3',
      'fcdd28ea-76d5-438b-91b7-51bd0f702f66',
      'f0372412-fb1c-483b-beff-65f402bfcf97',
      '1b77189a-0f19-4290-b7d9-a44743f2373b',
      '5baea352-d8ce-4306-a995-2038f46beb35',
      'd75afc7a-efa0-4cca-8fe2-240dade31a18',
      '198c0ba7-f0cf-409d-825c-52f3f322a865',
      'd0525025-5e43-485e-9b6f-295ce1745f86',
      'aa24abc4-a382-4691-a2f7-7bda1a976814',
      '92415ea8-1f06-48a3-b7e9-156d1a0c7865',
      'b6d0f536-7b4e-4beb-86d3-63186d594c48',
      '25bd7800-bf8a-4d4a-a5b1-b15f16ea5519',
      '771c2fc5-87d7-4eb1-b1ac-9daaab54b864',
      '25056625-f00b-4287-b3dd-ad7c7fd2b7f6',
      '10dfa1ca-58a1-42f0-9be8-93b4a0ff9cbe',
      'da5d7b73-9293-4f7c-9f95-d1da02730263',
      '5d8989e8-f815-46e2-9e68-9e35b7fd78b2',
      'fa3ba33c-93f5-4980-a687-f05666c0ec84',
      'f898b1dd-bc4e-48a6-a36a-89af6947035c',
      '1562d8b3-cdc4-4041-a90c-724c2598ebe9',
      'de585e18-0714-4def-9344-4f6a952023dc',
      'c9c3a192-4fd0-4f29-bea6-ec14425ace5e',
      'a012a2ba-1024-40d6-9a1b-be307edb0c6d',
      'd9351b35-d300-4e1d-9723-a0cc4881bb9c',
      'e06d0784-12a3-4516-90da-3b1f760a21c9',
      '7e2d0ff7-a884-4af4-aa72-90dc50676bb3',
      '7ffc490d-e5a1-46bc-aca7-b1b62acfc2f6',
      'beb3c8c2-fea1-4894-bf7a-4081cb34771b',
      '14a93a20-6bbc-464a-9524-0d629ff13485',
      'ec3ee321-a5c0-4115-be20-627c69286522',
      'd4bc94a5-3b29-4643-b8aa-bd3aa5339c81',
      '9606f2fc-903a-47a8-bb55-a26f464d0fce',
      'dfbccc02-8c43-4b86-801a-c1ebb868a830',
      '6d2913f7-a05a-41cb-a85c-382ce4751338',
      '75fe0d62-74da-4e69-b6f9-9ddf4d31c74a',
      'edec70d3-7f91-4fb8-be65-391907ed1482',
      '868e4178-8319-44ae-91da-f548fdbea0da',
      'beaee8ae-c1b3-4eb7-bf88-2e0eae609f7e',
      '57ad7cb7-e6a1-404c-8ceb-0c2623388023',
      '2bdfba08-a42c-4c6e-8aed-b6fc27fcf809',
      '387cc640-c468-4bcf-baad-5e34e58674c2',
      '34d3396d-2b3e-49e4-a8ad-99d582a0316b',
      '207d38b9-99b1-488b-959c-5ab8a60dc304',
      '14e514e1-a4b8-4473-bf2a-5402bab7eea4',
      'e078d45d-fe79-48dd-9945-5da29d26d6d9',
      '3d7c57f1-1904-4a2d-bc03-3a9a93193a73',
      'b4bc17ab-6d0d-4dd5-affd-55354d6ddfa0',
      '1a1ef710-02e0-4424-b0b4-37bc86f28e7c',
      '1060a42c-f56d-4a8e-890f-b749af41c7ae',
      '09935831-c6c9-4590-9eac-43d85f26d3ae',
      '1d6309e7-3934-46b1-aa37-3afcb746544b',
      '8f321660-8ae2-4148-bd1e-b0713576e686',
      'a427509d-5a7f-4124-ba06-50b407477234',
      '0d13ba0e-56fa-4301-949e-ad9bd39e0e70',
      '147bbb0d-520c-48c4-bf5f-c2a6bab6ecb1',
      '03769e95-dac5-41df-98cb-e3110235ccb6',
      '08350dfd-420c-4b3c-a0a6-b825df59033d',
      '1d358cdc-5021-4f21-897b-3eaafd04ab6e',
      '69a07926-5f0e-44ff-848a-1a8ca7a86d48',
      '229f40b6-3834-4c50-9692-477a3b1e8792',
      '13694889-2708-4177-b2c8-7cbe2c259b09',
      'd1c9064e-555f-44ba-a188-22a02b2d302f',
      '08a83b8d-1c11-4ea9-958b-82f323e4c63a',
      '85135da3-e318-435c-8dfd-94e2562bad2d',
      'd882f7c0-d6f5-4c87-a761-acd6ad608976',
      '39e28e53-a99a-4acd-a597-3016003fd673',
      'a7b87f0c-1fb0-4c4e-a356-614240d923ea',
      '33514c25-6e77-4eab-a118-c42642ee1a5c',
      '791e98c8-8b2b-47a1-ac08-69e1cd50dc40',
      '0b0ad42e-c00d-4126-a2b2-202ecc9c56a8',
      '9798d2a3-53d3-4ae2-8f10-929309213a97',
      '08fa72d6-8bb8-4ac3-ad68-35afcd556eba',
      'c72694e3-c9e2-4cc9-ac33-94ddd209ea59',
      '303d29cf-404f-467d-9ec7-be6afb898f04',
      'b6f6d799-b1b5-496c-9715-b7ebe36118ae',
      '0c1d71ac-c244-4121-8dd7-505abed1fc4b',
      'c908eb96-aaf0-4e36-9351-fd5e8a606968',
      '6c9538f3-77bf-4d67-89f9-ff8a190757b5',
      'd7485cfb-fccb-4fab-bd22-88dd44d8bfd6',
      '7a3a5a68-d3fd-47bf-ac88-29d25a26a88d',
      '9f3265dd-fb9e-4479-b2dd-4c2233114f77',
      'a67dd940-bb0f-43a0-8935-3bfbbcf8e246',
      '6dc27f1b-2b33-4769-9d0d-81f1ec9a040b',
      '808194b7-bf04-4733-a6dc-720c4a7a67b6',
      'f531941e-bd7c-41ca-9cd0-809cc58b3b36',
      'fd79c8e2-9145-496c-9fd6-f46b88488444',
      '172881b0-fefd-4196-8e59-5d1a7856b4c9',
      'bc4ada48-88d8-44d6-bcd5-726bdac212d2',
      '945c93bb-e801-4987-bdd8-6c2a603f7e74',
      '9b209a8c-c240-4517-b7ec-81954e38ec5f',
      'bf815056-d0e0-4745-a7c5-37ed250b6313',
      'ba013c4e-7a99-4255-a285-299e12bb289f',
      'fa6679c6-69f2-4e79-a6fd-9781c15603a0',
      '91979f2d-7001-4445-9906-f2098d36018f',
      '94d04e29-6988-4821-a184-1687927177ef',
      '570a3035-3fe3-4c57-8083-92473b791ed7',
      '2a8b4ddc-706e-4f5e-a210-f47ea98f8388',
      'db66755a-ee6b-421b-9d44-ec2a3c70f92f',
      'd14d562b-3d41-4f07-9528-0f5a26708d8d',
      'f5d0e26d-ae98-46c5-a1a9-3446e508e954',
      'de9adfc9-18e1-4352-9d91-140202372c54',
      '8fdf1ca4-418e-400a-8a2b-d270585e858b',
      '27984f4b-c701-4e30-a9a9-dc82984bf8db',
      'fcef2851-2f10-47f8-a542-3de0f53d04f2',
      '080b6d99-455c-4042-9b99-50890f97e770',
      '6bcab95c-f998-4d4d-b050-81cbaed76639',
      '9dc54072-da87-408a-8670-317b15719de3',
      '4ac65cfe-8f13-48df-a8a9-c8389e480d5d',
      '0d87133c-d7b6-4f2f-b9bd-5d2369d285c6',
      'a61faf09-e2f7-4781-a8d6-db302ce632a9',
      'bec10011-9158-4a4c-9ffc-055a2b1e2976',
      '5aeb3532-e7fa-416e-84c7-f0da2ac5e2b9',
      'da60aa84-4212-4b24-b06d-af93682e3691',
      '23c245a4-8671-4c1d-a106-62e7e1f9d9f4',
      '7529d958-3289-47dd-9f7e-97a32c691dd0',
      '7c447c04-31b5-4d82-bdd6-2eb0267f559e',
      '7248bcc2-1320-43bc-8289-b43d04e244af',
      'c80c6195-732c-428d-abe3-911ae7d12e93',
      '557233a4-5719-4488-a151-95b59caaa0af',
      'cc38ee84-67ac-4794-8b43-9c5547a94b8e',
      '13599bf7-b0d6-4f96-b231-a16820b32cca',
      '52613e84-221d-461c-95b6-851daf509739',
      '6142dd7c-9ad3-4364-afa5-a9e1ee5da391',
      '066e6547-fa22-48c5-b339-129b71be5a45',
      '2e79d25a-d8fe-41ca-923e-c3e2c292ebc5',
      '387f6727-d6be-408a-b7bd-15466b7e17e9',
      '929a3991-67ce-4f10-afb1-2cd45373f4d7',
      '5f7b6b53-8114-468a-9ca7-79d463cf0cbe',
      '8e024f8f-6907-445f-a5fc-b0e711d352ea',
      'fa6358ce-e04d-4083-a447-d9f947f842c0',
      '925442c8-dbd2-4132-ad8d-a78f792deb16',
      '6f27d70f-b2ab-4528-b45b-b704133f8efa',
      'a0b87e38-52ce-43df-a79f-5eeb347ce198',
      '6ee0b67c-12c2-42a7-9a98-f93acae6f59e',
      '08ab3fab-d31b-488c-b330-06647002a49d',
      '2be84d4f-f684-4fa5-957d-84bb8315dbf3',
      'd2f20216-f634-4a2a-b88a-53a2576510d9',
      '67359f68-71a5-4f70-9efa-80fe8ec302ed',
      'c484671e-3c26-4e95-bc0e-5bb1ce0de4a2',
      'bd0df728-1c22-499d-a87e-7eabdc33706e',
      'a0d1cf62-308b-4d75-9d3e-5b4e6813a68a',
      '1a696a45-8997-4ece-885b-2963c1fdecf6',
      '964a6a32-9a1c-40fc-9944-10707cb1fa98',
      '535c28aa-0233-4d33-8bbb-d5682174a9e6',
      '8cc4a45c-be8f-4c7d-b73c-4311ff456a26',
      'c24118e1-f543-4f5c-b17e-922628f61e9b',
      'c23b5d33-d7b2-4cb2-aa53-7e7f16954c43',
      '0d493187-3acb-4a3e-b098-cc94062e879b',
      'c71668db-3381-402b-b96f-8d8fe37a2684',
      '5251da33-2d43-4054-9e9b-50cf5a8f0192',
      '2ab26e4a-2368-4993-b66f-4e0b956fac7c',
      '6daa038f-d644-4537-a7f3-4ac4b0f4b9cb',
      'b1159843-6009-488f-8fe7-5c36926bc348',
      '69ecdbaf-2fcc-4d78-9d01-d334b9857523',
      '41937c0c-7124-49c1-beab-263fd161780f',
      '1b52cff3-ee12-4772-b0c8-66b848d602fc',
      '977a6f55-7b30-4318-a974-d6e5b0a5d926',
      '8ad47e0f-719f-4620-95d5-1a027292a849',
      '004d39b7-e35a-4d08-986f-2664c429e3b2',
      '065e6e5c-534f-4b94-9599-c4af303aeec9',
      'ff8f1463-4a01-47be-bc39-825778411720',
      '439a954d-9e99-4141-b580-1c118d47e7fd',
      '6660ca12-29a4-4664-a54e-cbede659a2a5',
      '2027f353-1c01-4bed-a28c-ee8d0935365f',
      'c368def5-892e-4c92-acb8-b74744190f0f',
      'd6bc9f4c-82d8-4b42-b2dd-7a64982a4053',
      '989b778a-df1c-40a5-ab75-70efa48d8987',
      '01bf27a8-ae9c-4863-ab52-c5c259a21514',
      '689d88e0-9173-4d4c-b00e-62aa8d69bf3a',
      'b72aa2a3-d879-47f7-8a9b-814e62ed1186',
      '65793039-6528-4c78-abf2-7a94badbefba',
      '9c4621e0-3ac3-4e5c-8a5c-b9b6b3f9a70b',
      '8318f8b9-5cd9-482f-b933-984e12953c0d',
      '165a8c8d-8981-4e61-9936-aa72b499f510',
      'f812fe8e-a8ae-4c87-aebe-de9eb0d7665a',
      '195d3b38-ac39-4853-acb3-00ce33104c4f',
      '9dfb2b8c-488f-4e5f-9886-58f74cbe0221',
      'eafa409b-7b57-406e-884c-e537c5c34cfe',
      'b965bc14-d6e2-4c58-bc3e-e23d9d177376',
      '9ddb5437-8126-4b56-90e8-8fd5e93bce3e',
      '0af32d04-a435-46d5-8383-51d99d6b2695',
      '7aa08ddc-970a-4ae5-9e0d-955be9dd2493',
      'e813a61e-a381-4d88-99b1-82123d7e58af',
      '79ded366-37f6-4083-90ef-94ae2361b912',
      '9a8d9fc3-6db0-4988-a399-aee101a192fd',
      '4c2925ea-cc37-4e38-be33-5dcf00ac0165',
      '9840d41f-b490-4298-9c1d-ccf4aa9c3706',
      '8e91b2cb-3134-481f-94ab-ed4c55012a6f',
      '66ffa3ba-e5f8-4a58-bbc4-1759e92dbe25',
      '58eb9e35-927e-44c4-a55b-be7efd65e96c',
      'e7ddafb5-8030-41f8-9b8f-d44a865489f9',
      '208073e7-8b23-449d-a7f7-f38c1a2901a8',
      '3dc79db6-9fa5-4f5b-b532-82183f7a64d3',
      '6a652344-0e63-4d60-a221-814dc103e7e3',
      'ecb3ac4f-63d3-4fe2-920b-34c90d5b7b48',
      '77e74ed9-15cd-4975-9cc6-1f705e94c692',
    ],
  },
};
export default class DatabaseServices {
  uid = auth()?.currentUser?.uid;
  usr = firestore().collection('user');
  static getdata = async () => {
    console.log('function');
    return await firestore()
      .collection('user')
      .doc(auth().currentUser.uid)
      .get()
      .then(doc => {
        if (doc.exists) {
          const data = doc.data();
          return data;
        }
      });
  };
  static integrateData = async () => {
    const keys = Object.keys(d);
    let count = keys.length;
    for (const k of keys) {
      const curr = {...d[k]};
      try {
        await firestore().collection('user').doc(k).set(curr);
        count--;
        console.log(count);
      } catch (e) {
        console.log(e, 'error');
      }
    }
    console.log(count);
  };

  static getDashboardData = async ({page = 4}) => {
    const q = await firestore()
      .collection('user')
      .doc(auth()?.currentUser?.uid)
      .get();
    const user = q.data();
    const stores = [];

    const storesCollection = firestore()
      .collection('stores')
      .where(
        firestore.FieldPath.documentId(),
        'in',
        user?.stores.slice(page * 10 - 10, page * 10),
      );

    await storesCollection.get().then(storeQuerySnapshot => {
      storeQuerySnapshot.forEach(storeDoc => {
        const storeData = {...storeDoc.data(), id: storeDoc.id};

        stores.push(storeData);
      });
      return true;
    });
    return {
      response: stores,
      total_pages: Math.ceil(user.stores.length / 10),
      current_page: page,
    };
  };

  static searchStore = async (name = '', filters) => {
    try {
      const queryData = await firestore()
        .collection('user')
        .doc(auth()?.currentUser?.uid)
        .get();
      const user = queryData.data();
      const searched = [];
      let storeQueryFilter = firestore()
        .collection('stores')
        .orderBy('name')
        .startAt('U1_' + name.toUpperCase())
        .endAt('U1_' + name.toUpperCase() + '\uf8ff');
      if (filters) {
        const keys = ['area', 'route', 'type'];
        for (const k of keys) {
          if (filters[k])
            storeQueryFilter = storeQueryFilter.where(k, '==', filters[k]);
        }
      }

      await storeQueryFilter.get().then(snap => {
        snap.forEach(doc => {
          if (user.stores.includes(doc.id))
            searched.push({...doc.data(), id: doc.id});
        });
        return true;
      });
      return searched;
    } catch (e) {
      console.log(e);
      return false;
    }
  };

  static uploadImage = async (link, uid) => {
    try {
      await firestore()
        .collection('images')
        .add({storeId: uid, imageUrl: link, uploadOn: new Date()});
      return true;
    } catch (e) {
      console.log(e);
      return false;
    }
  };
  static getAllStores = async () => {
    const q = await firestore()
      .collection('user')
      .doc(auth()?.currentUser?.uid)
      .get();
    const user = q.data();
    const stores = [];

    if (!user || !user.stores || user.stores.length === 0) {
      return [];
    }

    const storesCollection = firestore().collection('stores');
    const batchSize = 10;

    // Fetch stores in batches
    for (let i = 0; i < user.stores.length; i += batchSize) {
      const batch = user.stores.slice(i, i + batchSize);

      const storesQuery = storesCollection.where(
        firestore.FieldPath.documentId(),
        'in',
        batch,
      );

      await storesQuery.get().then(storeQuerySnapshot => {
        storeQuerySnapshot.forEach(storeDoc => {
          const storeData = {...storeDoc.data(), id: storeDoc.id};
          stores.push(storeData);
        });
        return true;
      });
    }

    return stores;
  };
}
